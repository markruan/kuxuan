<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>圈子</title>
    <link href="../../css/Hui.css" rel="stylesheet" type="text/css" />
    <link href="../../css/iconfont.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        html,
        body {
            background-color: white
        }

        .iconfont {
            font-size: 39px;
        }

        #imgg {
            height: 44px;
            margin-left: 60px
        }

        .H-button {
            min-width: 0;
        }
    </style>
    <script type="text/html" id="tppl">
        <% for(var i=0; i < list.length; i++){ if(list[i].type==1){%>
            <div class="bbs-item H-border-vertical-bottom-after">
                <div class="H-flexbox-horizontal H-theme-background-color-white  ">
                    <div class="H-padding-vertical-both-8">
                        <img data-echo="<%=imageCache(list[i].pic) %>" src="../../image/default.jpg" alt="" title="" class="animated fadeIn H-display-block H-margin-horizontal-left-10 H-border-radius-circle H-width-45 H-height-45">
                    </div>
                    <div class="H-flex-item H-margin-10">
                        <div class="H-theme-font-color-999 H-font-size-14 H-flexbox-horizontal H-text-horizontal-left H-box-sizing-border-box">
                            <span class="H-display-block H-flex-item H-text-align-left H-font-size-14"><span class="H-theme-font-color1"><%=list[i].nickname %></span></span>
                            <span class="H-display-block H-flex-item H-text-align-right H-theme-font-color-999 H-font-size-12" id="times">
			<button class="H-button H-font-size-12 H-outline-none H-theme-background-color-transparent  H-padding-horizontal-both-10 H-theme-font-color2 H-theme-border-color-pink H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-5"><span class="H-badge H-display-inline-block">
			<!--<i class="H-iconfont H-icon-plus H-font-size-14 H-vertical-right"></i>-->
			</span>图片
                            </button>
                            </span>
                        </div>
                        <div class="H-theme-font-color-999 H-text-show-row-1 H-margin-vertical-top-2 H-font-size-12">
                            <%=list[i].signature %>
                        </div>
                    </div>
                </div>
                <div class="H-theme-background-color-white H-clear-both H-width-100-percent H-display-table H-box-sizing-border-box H-padding-horizontal-left-10">
                    <% if(list[i].tushu>0){ for(var k=0; k <list[i].tushu; k++){%>
                        <div class="H-display-table-cell H-float-left  H-box-sizing-border-box H-width-avg-3 H-padding-horizontal-right-10 H-margin-vertical-bottom-5 H-margin-vertical-top-10">
                            <img tapmode onclick="openPhoto('<%=JSON.parse(list[i].cover) %>',<%=k%>) " data-echo="<%=imageCache(JSON.parse(list[i].thumb)[k]) %>" src="../../image/default.jpg" class="H-width-100-percent  H-display-block H-border-radius-3 " alt="" title="" style="">
                        </div>
                        <%	}}else{  %>
                            <div class="H-display-table-cell H-float-left  H-box-sizing-border-box H-width-avg-2 H-padding-horizontal-right-10  H-margin-vertical-top-10">
                                <img tapmode onclick=" openPhoto('<%=list[i].cover %>',0) " data-echo="<%=imageCache(list[i].cover) %>" src="../../image/default.jpg" class="H-width-100-percent  H-display-block H-border-radius-3 " alt="" title="">
                            </div>
                            <%}%>
                </div>
                <div class=" H-theme-background-color-white H-theme-font-color-333 H-padding-5 H-font-size-14" tapmode>
                    <%=list[i].text%>
                </div>
                <div class="H-flexbox-horizontal H-clear-both H-theme-background-color-white H-padding-8 H-box-sizing-border-box  ">
                    <span tapmode onclick="openComm(<%=list[i].data_id %>,3)" class="H-font-size-14 H-flex-item  H-center-all H-theme-font-color2  "><i  class="H-iconfont H-icon-review-fill  H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-vertical-middle"><%=list[i].comm.count==0?'':list[i].comm.count%></label></span>
                    <span class="H-font-size-14 H-flex-item  H-center-all   "><i tapmode  onclick="dianzan(<%=list[i].data_id %>,this)" class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"><%=list[i].zan==0?'':list[i].zan%></label></span>
                    <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                    <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                    <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                    <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                    <span tapmode onclick="shareImg('<%=list[i].cover %>')" class="H-font-size-14 H-flex-item  H-center-all   "><i class="H-iconfont H-icon-share-to H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"> </label></span>
                </div>
            </div>
            <% }else if(list[i].type==2){%>
                <div class="bbs-item H-border-vertical-bottom-after">
                    <div class="H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-after">
                        <div class="H-padding-vertical-both-8">
                            <img data-echo="<%=imageCache(list[i].pic) %>" src="../../image/default.jpg" alt="" title="" class="animated fadeIn H-display-block H-margin-horizontal-left-10 H-border-radius-circle H-width-45 H-height-45">
                        </div>
                        <div class="H-flex-item H-margin-10">
                            <div class="H-theme-font-color-999 H-font-size-14 H-flexbox-horizontal H-text-horizontal-left H-box-sizing-border-box">
                                <span class="H-display-block H-flex-item H-text-align-left H-font-size-14"><span class="H-theme-font-color1"><%=list[i].nickname %></span></span>
                                <span class="H-display-block H-flex-item H-text-align-right H-theme-font-color-999 H-font-size-12" id="times">
			<button class="H-button H-font-size-12 H-outline-none H-theme-background-color-transparent  H-padding-horizontal-both-10 H-theme-font-color2 H-theme-border-color-pink H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-5"><span class="H-badge H-display-inline-block">
			<!--<i class="H-iconfont H-icon-plus H-font-size-14 H-vertical-right"></i>-->
			</span>文字
                                </button>
                                </span>
                            </div>
                            <div class="H-theme-font-color-999 H-text-show-row-1 H-margin-vertical-top-2 H-font-size-12">
                                <%=list[i].signature %>
                            </div>
                        </div>
                    </div>
                    <div class="H-theme-background-color-white H-clear-both H-width-100-percent H-display-table H-box-sizing-border-box H-padding-horizontal-left-10" tapmode onclick=" openPhoto('<%=list[i].cover %>') ">
                    </div>
                    <div class="H-theme-background-color-white H-theme-font-color-333 H-padding-10 H-font-size-14">
                        <%=list[i].text %>
                    </div>
                    <div class="H-flexbox-horizontal H-clear-both H-theme-background-color-white H-padding-8 H-box-sizing-border-box  r">
                        <span tapmode onclick="openComm(<%=list[i].data_id %>,3)" class="H-font-size-14 H-flex-item  H-center-all H-theme-font-color2  "><i  class="H-iconfont H-icon-review-fill  H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-vertical-middle"><%=list[i].comm.count==0?'':list[i].comm.count%></label></span>
                        <span class="H-font-size-14 H-flex-item  H-center-all    "><i tapmode onclick="dianzan(<%=list[i].data_id %>,this)" class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"><%=list[i].zan==0?'':list[i].zan%></label></span>
                        <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                        <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                        <span class="H-font-size-14 H-flex-item  H-center-all"> </span>

                        <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                        <span tapmode onclick="shareImg('<%=list[i].cover %>')" class="H-font-size-14 H-flex-item  H-center-all    "><i class="H-iconfont H-icon-share-to H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"> </label></span>
                    </div>
                </div>
                <% }else{%>
                    <div class="bbs-item H-border-vertical-bottom-after">
                        <div class="H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-after">
                            <div class="H-padding-vertical-both-8">
                                <img data-echo="<%=imageCache(list[i].pic) %>" src="../../image/default.jpg" alt="" title="" class="animated fadeIn H-display-block H-margin-horizontal-left-10 H-border-radius-circle H-width-45 H-height-45">
                            </div>
                            <div class="H-flex-item H-margin-10">
                                <div class="H-theme-font-color-999 H-font-size-14 H-flexbox-horizontal H-text-horizontal-left H-box-sizing-border-box">
                                    <span class="H-display-block H-flex-item H-text-align-left H-font-size-14"><span class="H-theme-font-color1"><%=list[i].nickname %></span></span>
                                    <span class="H-display-block H-flex-item H-text-align-right H-theme-font-color-999 H-font-size-12" id="times">
			<button class="H-button H-font-size-12 H-outline-none H-theme-background-color-transparent  H-padding-horizontal-both-10 H-theme-font-color2 H-theme-border-color-pink  H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-5" ><span class="H-badge H-display-inline-block">
			<!--			<i class="H-iconfont H-icon-plus H-font-size-14 H-vertical-right"></i>-->
			</span>音乐
                                    </button>
                                    </span>
                                </div>
                                <div class="H-theme-font-color-999 H-text-show-row-1 H-margin-vertical-top-2 H-font-size-12">
                                    <%=list[i].signature %>
                                </div>
                            </div>
                        </div>
                        <div class="H-flexbox-horizontal H-theme-background-color-white  H-clear-both">
                            <div class="H-padding-vertical-both-10 H-box-sizing-border-box H-padding-horizontal-left-10"><img data-echo="<%=imageCache(list[i].cover) %>" src="../../image/default.jpg" alt="" title="" class="H-display-block " style="width: 90px; height: 90px;border-radius: 5px;"></div>
                            <div class="H-flex-item H-padding-10 H-padding-horizontal-left-10 H-position-relative H-box-sizing-border-box" style="height: 90px;">
                                <strong class="H-font-weight-normal font-weight-200 H-font-size-16 H-display-block H-text-show-row-2 H-margin-vertical-top-8">
			<span class="H-badge H-display-inline-block H-position-absolute H-z-index-10 " style="left: -65px;bottom: 10px;margin-bottom: 2px; "> <i data-click="0" tapmode onclick=" switchplay(this,'<%=list[i].mp3%>','<%=list[i].sid%>','<%=i%>','<%=list[i].cover%>','<%=list[i].title%>','<%=list[i].artist%>') " class=" pplay iconfont icon-bofang H-theme-font-color-white  H-font-size-10"></i></span>
			<img src="../../image/refresh.png" style="height: 16px;" alt="" /><%=list[i].title %></strong>
                                <p class="H-font-size-12 H-theme-font-color-999 H-position-absolute H-z-index-10 H-margin-0 H-margin-vertical-top-5"> <span style="padding-left: 16px;"><%=list[i].artist %></span></p>
                                <p class="H-font-size-12 H-theme-font-color-999 H-position-absolute H-z-index-10 H-margin-0 H-margin-vertical-top-5" style="bottom: 1px; left: 10px; right: 10px; padding-left: 16px;"><span class="H-float-left"><%=list[i].text%></span><span class="H-float-right"></span></p>
                            </div>
                        </div>
                        <div class="H-flexbox-horizontal H-clear-both H-theme-background-color-white H-padding-8 H-box-sizing-border-box  ">
                            <span tapmode onclick="openComm(<%=list[i].data_id %>,3)" class="H-font-size-14 H-flex-item  H-center-all H-theme-font-color2  "><i  class="H-iconfont H-icon-review-fill   H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-vertical-middle"><%=list[i].comm.count==0?'':list[i].comm.count%></label></span>
                            <span tapmode onclick=" shouCang(<%=list[i].sid %>,'<%=list[i].user %>','<%=list[i].mp3 %>','<%=list[i].artist %>','<%=list[i].title %>','<%=list[i].cover %>')" class="H-font-size-14 H-flex-item  H-center-all"><i class="H-iconfont H-icon-like H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"></label></span>
                            <span class="H-font-size-14 H-flex-item  H-center-all    "><i tapmode onclick="dianzan(<%=list[i].data_id %>,this)" class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"><%=list[i].zan==0?'':list[i].zan%></label></span>
                            <span class="H-font-size-14 H-flex-item  H-center-all"> </span>
                            <span class="H-font-size-14 H-flex-item  H-center-all"> </span>

                            <span class="H-font-size-14 H-flex-item  H-center-all"> </span>

                            <span tapmode onclick="share('<%=list[i].title %>','<%=list[i].artist %>','<%=list[i].cover %>','<%=list[i].sid %>')" class="H-font-size-14 H-flex-item  H-center-all    "><i class="H-iconfont H-icon-share-to H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle"> </label></span>
                        </div>
                    </div>
                    <% }}%>
    </script>
</head>

<body>
    <!--   <p class="H-padding-horizontal-both-10 H-font-size-16">下面数据是通过H.tppl模板引擎渲染的</p> -->
    <div id="main" class="result"></div>
    <!-- <div id="more" class="H-flexbox-horizontal  H-font-size-16 H-theme-background-color-white H-center-all "><span style="line-height:40px;">没有了...</span></div> -->
    <div class="H-header  H-display-block H-theme-background-color-white" id="footbar">
        <span id="footer">
        <span class="H-icon H-position-relative H-display-inline-block H-float-left H-vertical-middle H-theme-font-color-white H-padding-horizontal-left-5 H-z-index-100"><img id="imgg" src="../../image/loading.gif" alt=""></span>
        <div class="H-header-title H-center-all H-font-size-14 H-text-show-row-1 H-theme-font-color-ccc H-position-absolute H-width-100-percent">加载中......</div>
        </span>
    </div>
    <script src="../../script/H.js" type="text/javascript"></script>
    <script src="../../script/play.js" type="text/javascript"></script>
    <script src="../../script/api.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../script/echo.min.js"></script>
    <script src="../../script/comm.js" type="text/javascript"></script>
    <script type="text/javascript">
        // 点击效果初始化

        function allPlayicon(){
          var dd = document.getElementsByClassName('icon-zanting');
                for (i = 0; i < dd.length; i++) {
                    $api.attr(dd[i], 'class', 'iconfont  icon-bofang H-theme-font-color-white');
                }
        }

        H.tppl_flag = ["<%", "%>"];
        var page = 0

        function initPage() {
            // uiloading();

            var ye = page * 10
            api.ajax({
                url: hostUrl + '/quan123.php?page=' + ye,
                cache: true,
            }, function(ret, err) {
                if (ret) {
                    // console.log(JSON.stringify(ret));
                    var playlist = ret
                    var data1 = {
                        list: []
                    }
                    var data = {
                        list: ret
                    };

                    var render = H.tppl(H.D("#tppl").innerHTML);
                    if (page == 0) {
                        H.D(".result").innerHTML = render(data1);
                        H.D(".result").innerHTML = render(data);
                    } else {
                        $api.after($api.last(H.D(".result")), render(data))
                    }

                    echo.init({
                        offset: 10,
                        throttle: 200,
                        unload: false,
                        callback: function(element, op) {}
                    });
                    stoploading();
                } else {
                    $api.html($api.byId('footer'), '<div  class="H-header-title H-center-all H-font-size-14 H-text-show-row-1 H-theme-font-color-ccc H-position-absolute H-width-100-percent">没有更多了......</div>');

                }
                // api.parseTapmode();

            });

        }

        apiready = function() {
            var audio = api.require('audioPlayer');

            api.addEventListener({
                name: 'playNext'
            }, function(ret, err) {
                if (ret) {
                    var dd = document.getElementsByClassName('icon-zanting');
                    for (i = 0; i < dd.length; i++) {
                        $api.attr(dd[i], 'class', 'iconfont  icon-bofang H-theme-font-color-white');
                    }
                } else {
                    //  alert( JSON.stringify( err ) );
                }
            });
            api.addEventListener({
                name: 'scrolltobottom',
                extra: {
                    threshold: 480 //设置距离底部多少距离时触发，默认值为0，数字类型
                }
            }, function(ret, err) {

                page++

                initPage()

            });

            initPage(page)
            api.setRefreshHeaderInfo({
                loadingImg: 'widget://image/refresh.png',
                visible: true,
                bgColor: '#f2f2f2',
                textColor: '#4d4d4d',
                textDown: '下拉刷新...',
                textUp: '松开刷新...',
                showTime: true
            }, function(ret, err) {
                var html = ''
                page = 0
                html +=
                    '  <span class="H-icon H-position-relative H-display-inline-block H-float-left H-vertical-middle H-theme-font-color-white H-padding-horizontal-left-5 H-z-index-100"><img id="imgg" src="../../image/loading.gif" alt=""></span>';
                html += ' <div  class="H-header-title H-center-all H-font-size-14 H-text-show-row-1 H-theme-font-color-ccc H-position-absolute H-width-100-percent">加载中......</div>';
                $api.html($api.byId('footer'), html);
                initPage();
                // $api.removeClass($api.byId('footbar'), 'H-display-none')
                api.refreshHeaderLoadDone();
            });
            api.addEventListener({
                name: 'pause'
            }, function(ret, err) {
                if (ret) {
                    var audioPlayer = api.require('audioPlayer');
                    audioPlayer.pause();
                    // pause()
                }
            });

        }

        function dianzan(id, button, zan) {
            api.ajax({
                url: hostUrl + '/quanZ.php',
                method: 'post',
                timeout: 30,
                dataType: 'text',
                returnAll: false,
                data: {
                    values: {
                        id: id,
                    },
                }
            }, function(ret, err) {
                if (ret == 1) {
                    $api.attr(button, 'class', 'H-iconfont H-icon-ding-null H-theme-font-color-red H-font-size-18 H-margin-horizontal-right-5 animated zoomInUp');
                    var zan = button.nextSibling
                    $api.text(zan, eval($api.text(zan)) + 1);
                    $api.attr(zan, 'style', 'color: #ff003c');
                }
            });
        }

        function shareImg(url) {
            api.openFrame({
                name: 'sing_share',
                url: '../../html/single_share_body.html',
                rect: {
                    x: 0,
                    y: 0,
                    w: api.winWidth,
                    h: api.winHeight
                },
                pageParam: {
                    img: url
                },
            });
        }
    </script>
</body>

</html>
